# Taint a register, store/load it from memory with a bad label, and then write it to a different channel.

program:
  - [taint, null, 0, true, 1] # taint r0 1
  - [store, null, 0, true, 2] # store [2] r0
  - [load,  1, null, true, 2] # load r1 [2]
  - [sink,  null, 1, true, 2] # sink r1 2

init_mem:
  - start: 2
    len: 1
    read_only: false
    secret: true
    data: [10]
    tainted: [0xFFFF]

params:
  num_regs: 2
  trace_len: 5

trace:
  - [0, [0,0], [0xFFFF,0xFFFF]]
  - [1, [0,0], [1,0xFFFF]]
  - [2, [0,0], [1,0xFFFF]]
  - [3, [0,0], [1,1]]
  - [4, [0,0], [1,1]]

advice:
  2: [[MemOp, 2, 0, write, 4]]
  3: [[MemOp, 2, 0,  read, 5]]
